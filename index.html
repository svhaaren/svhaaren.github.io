<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MENACE Streichholzschachteln mit Spielfeld</title>
<style>
  .box-container {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    padding: 20px;
  }
.input-grid-container {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    padding: 20px;
  }
  .box{
    width: 180px;
    height: auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    border: 2px solid black;
    padding: 10px;
    font-family: Arial, sans-serif;
  }
 .input-grid {
    width: 180px;
    height: auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    border: 2px solid black;
    padding: 10px;
    font-family: Arial, sans-serif;
  }

  .input-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 5px;
    width: 20%;
  }

 .grid {
    display: grid;
    grid-template-columns: repeat(3, 50px); /* Ändern Sie die Breite der Zellen */
    gap: 5px;
    width: auto; /* Ändern Sie die Breite des Grid-Containers */
    margin-top: 10px; /* Abstand zwischen den Grids hinzufügen */
  }

  .cell {
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid #aaa;
    font-size: 24px;
  }

  .input-cell {
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid #aaa;
    font-size: 24px;
  }

  select {
    width: 100%;
    height: 100%;
    font-size: large;
  }
  .box-number {
    margin-top: 10px;
    font-size: 14px;
  }
  .search-container {
    margin-bottom: 20px;
    display: flex;
    justify-content: space-between;
  }
  .search-input {
    padding: 10px;
    width: 48%;
  }
.transformation-container {
    display: flex; /* Ändern Sie die Anzeige auf flex */
    flex-wrap: wrap; /* Erlauben Sie das Umbruch von Elementen */
    gap: 10px;
    padding: 20px;
    width: 100%; /* Hinzugefügt */
  }
  .transformation-title {
    font-size: 16px;
    font-weight: bold;
  }
</style>
</head>
<body>

<div class="search-container">
  <input type="text" id="searchNumberInput" class="search-input" onkeyup="searchBoxesByNumber()" placeholder="Suche nach Box-Nummer...">
  <input type="text" id="searchNotationInput" class="search-input" onkeyup="searchBoxesByNotationWithTransformations()" placeholder="Suche nach Notation (z.B. X;;;;;;;;O)">
</div>

<div id="inputGridContainer" class="input-grid-container">
  <!-- Das Eingabe-Grid wird hier platziert -->
  <div id="inputGrid" class="input-grid box"></div>
  <button onclick="submitInput()">Absenden</button>
</div>
<div id="transformationContainer" class="transformation-container"></div>
<div id="boxContainer" class="box-container"></div>

<script>
const boxStates = [
  "(;;;;;;;;)",
  "(O;X;;;;;;;)",
  "(O;;;;X;;;;)",
  "(O;;;;;X;;;)",
  "(X;O;;;;;;;)",
  "(;O;;;X;;;;)",
  "(X;;O;;;;;;)",
  "(;X;;O;;;;;)",
  "(X;;;;O;;;;)",
  "(;X;;;O;;;;)",
  "(X;;;;;O;;;)",
  "(;X;;;;;;O;)",
  "(X;;;;;;;;O)"
];

const boxes = boxStates.map((state, index) => ({
  id: index + 1, 
  label: `Schachtel ${index + 1}`, 
  state: state,
  displayState: state.substring(1, state.length - 1).split(';').map(s => s === "" ? " " : s)
}));

function createBoxes(boxesToDisplay = boxes) {
  const container = document.getElementById('boxContainer');
  container.innerHTML = '';
  boxesToDisplay.forEach(box => {
    const boxElement = document.createElement('div');
    boxElement.classList.add('box');
    const grid = document.createElement('div');
    grid.classList.add('grid');
    
    box.displayState.forEach(cellState => {
      const cell = document.createElement('div');
      cell.classList.add('cell');
      cell.textContent = cellState;
      grid.appendChild(cell);
    });
    
    const numberElement = document.createElement('div');
    numberElement.classList.add('box-number');
    numberElement.textContent = box.label;
    
    // Rotate-Button hinzufügen
    const rotateButton = document.createElement('button');
    rotateButton.textContent = 'Rotate';
    rotateButton.onclick = () => showTransformations(box.state);

    boxElement.appendChild(grid);
    boxElement.appendChild(numberElement);
    boxElement.appendChild(rotateButton); // Button hinzufügen
    container.appendChild(boxElement);
  });
}

function showTransformations(state) {
  const transformations = generateTransformations(state);
  const transformationContainer = document.getElementById('transformationContainer');
  transformationContainer.innerHTML = ''; // Bereinige den Container für neue Inhalte
  transformationContainer.style.display = 'flex';

  transformations.forEach(transformation => {
    const transGrid = document.createElement('div');
    transGrid.classList.add('box'); // Angepasst
    transGrid.classList.add('grid'); // Angepasst
    const transState = transformation.substring(1, transformation.length - 1).split(';');
    
    // Erstelle ein Mini-Grid für jede Transformation
    transState.forEach(cellState => {
      const cell = document.createElement('div');
      cell.classList.add('cell');
      cell.textContent = cellState === 'X' || cellState === 'O' ? cellState : ' ';
      transGrid.appendChild(cell);
    });

    transformationContainer.appendChild(transGrid);
  });
}

function generateTransformations(state) {
  let grid = state.substring(1, state.length - 1).split(';');

  const rotate = (grid) => {
    return [
      grid[6], grid[3], grid[0],
      grid[7], grid[4], grid[1],
      grid[8], grid[5], grid[2],
    ];
  };

  const mirrorHorizontal = (grid) => {
    return [
      grid[2], grid[1], grid[0],
      grid[5], grid[4], grid[3],
      grid[8], grid[7], grid[6],
    ];
  };

  let transformations = [grid];
  for (let i = 0; i < 3; i++) {
    transformations.push(rotate(transformations[i]));
  }

  transformations.forEach(transformation => {
    transformations.push(mirrorHorizontal(transformation));
  });

  transformations = transformations.map(trans => `(${trans.join(';')})`);
  transformations = [...new Set(transformations)];

  return transformations;
}

function searchBoxesByNumber() {
  const input = document.getElementById('searchNumberInput').value.trim();
  const filteredBoxes = boxes.filter(box => box.label.toLowerCase().includes(input.toLowerCase()));
  createBoxes(filteredBoxes);
}

function searchBoxesByNotationWithTransformations() {
  const input = document.getElementById('searchNotationInput').value.trim().toUpperCase();
  const transformations = generateTransformations(input);
  const filteredBoxes = boxes.filter(box => transformations.includes(box.state.toUpperCase()));
  createBoxes(filteredBoxes);
}

function submitInput() {
  const inputGrid = document.getElementById('inputGrid').getElementsByTagName('select');
  let notation = '(';
  for (let i = 0; i < inputGrid.length; i++) {
    notation += inputGrid[i].value;
    if (i < inputGrid.length - 1) notation += ';';
  }
  notation += ')';
  document.getElementById('searchNotationInput').value = notation;
  searchBoxesByNotationWithTransformations();
}

function initInputGrid() {
  const inputGrid = document.getElementById('inputGrid');
  inputGrid.innerHTML = ''; // Ensure the grid is empty before initializing
  for (let i = 0; i < 9; i++) {
    const cell = document.createElement('div');
    cell.classList.add('input-cell');
    const select = document.createElement('select');
    select.onchange = submitInput; // Update to automatically submit on change
    select.innerHTML = `<option value=''> </option><option value='X'>X</option><option value='O'>O</option>`;
    cell.appendChild(select);
    inputGrid.appendChild(cell);
  }
}

createBoxes();
initInputGrid();
</script>
</body>
</html>
